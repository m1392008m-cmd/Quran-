<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¯ÙŠÙˆØ§Ù† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ù„ÙƒÙŠ</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:ital,wght@0,700;1,700&family=Reem+Kufi:wght@500;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --royal-blue: #003366;
            --gold: #d4af37;
            --deep-red: #7f1d1d;
            --papyrus: #f4ece1;
        }

        body {
            background-color: #0f172a;
            background-image: radial-gradient(circle, #1e293b 0%, #0f172a 100%);
            color: var(--gold);
            font-family: 'Reem Kufi', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            min-height: 100vh;
        }

        /* Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ù„ÙƒÙŠØ© */
        .card-box {
            width: 380px;
            height: 550px;
            background: var(--papyrus);
            border: 5px solid var(--gold);
            position: relative;
            padding: 50px 30px;
            box-sizing: border-box;
            box-shadow: 0 0 50px rgba(0,0,0,0.5), inset 0 0 100px rgba(212, 175, 55, 0.1);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            border-radius: 5px;
        }

        /* Ø²Ø®Ø§Ø±Ù Ø§Ù„Ø²ÙˆØ§ÙŠØ§ Ø§Ù„ÙØ±Ø¹ÙˆÙ†ÙŠØ©-Ø§Ù„Ø¹Ø«Ù…Ø§Ù†ÙŠØ© */
        .card-box::before {
            content: "ğ“‹¹";
            position: absolute; top: 15px; font-size: 2rem; color: var(--royal-blue);
        }

        .corner-ornament {
            position: absolute;
            width: 40px;
            height: 40px;
            border: 3px solid var(--gold);
        }
        .top-right { top: 10px; right: 10px; border-bottom: none; border-left: none; }
        .bottom-left { bottom: 10px; left: 10px; border-top: none; border-right: none; }

        #display-text {
            font-family: 'Amiri', serif;
            color: #2d2d2d;
            font-size: 1.6rem;
            line-height: 2;
            text-align: center;
            z-index: 2;
            font-style: italic;
            transition: all 0.5s ease;
        }

        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¯ÙŠÙˆØ§Ù† */
        .grid-menu {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            width: 100%;
            max-width: 380px;
            margin-top: 30px;
        }

        button {
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            color: var(--gold);
            border: 1px solid var(--gold);
            cursor: pointer;
            font-family: 'Reem Kufi', sans-serif;
            font-size: 1.1rem;
            transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            backdrop-filter: blur(5px);
        }

        button:hover {
            background: var(--gold);
            color: var(--royal-blue);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(212, 175, 55, 0.3);
        }

        .btn-main {
            grid-column: span 2;
            background: var(--royal-blue);
            color: white;
            border: 2px solid var(--gold);
            font-weight: bold;
            font-size: 1.3rem;
        }

        #loader {
            height: 25px;
            margin-top: 10px;
            font-size: 0.9rem;
            color: #fff;
            text-shadow: 0 0 5px var(--gold);
        }

        /* Ø§Ù„Ø®ØªÙ… Ø§Ù„Ø³ÙÙ„ÙŠ */
        .royal-seal {
            position: absolute;
            bottom: 20px;
            font-family: 'Amiri';
            font-size: 0.8rem;
            color: var(--gold);
            border-top: 1px solid var(--gold);
            padding-top: 5px;
            width: 80%;
            text-align: center;
        }
    </style>
</head>
<body>

    <h1 style="font-family: 'Amiri'; font-size: 3rem; margin-bottom: 5px;">Ø¯ÙŠÙˆØ§Ù† Ø§Ù„Ø­ÙƒÙ…Ø© Ø§Ù„Ù…Ù„ÙƒÙŠ</h1>
    <p style="color: var(--gold); margin-bottom: 20px;">Ø§Ø³ØªØ­Ø¶Ø± Ø¨Ø±ÙƒØ© Ø§Ù„ÙƒÙ„Ù…Ø© Ù…Ù† Ø®Ø²Ø§Ø¦Ù† Ø§Ù„Ø¯ÙŠÙˆØ§Ù†</p>

    <div class="card-box" id="myCard">
        <div class="corner-ornament top-right"></div>
        <div class="corner-ornament bottom-left"></div>
        
        <div id="display-text">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø±Ø­Ø§Ø¨ Ø§Ù„Ø¯ÙŠÙˆØ§Ù†.. Ø§Ø®ØªØ± Ø¨Ø§Ø¨Ø§Ù‹ Ù„ÙØªØ­ Ø§Ù„Ù…Ø®Ø·ÙˆØ·Ø©.</div>
        
        <div class="royal-seal">
            Ø®ØªÙ… Ø§Ù„Ø¯ÙŠÙˆØ§Ù† Ø§Ù„Ù…Ù„ÙƒÙŠ Ù„Ø¹Ø§Ù… Ù¢Ù Ù¢Ù¦ 
        </div>
    </div>

    <div id="loader"></div>

    <div class="grid-menu">
        <button onclick="smartFetch('azkar.html')">ğ“‹¹ Ø¨Ø§Ø¨ Ø§Ù„Ø£Ø°ÙƒØ§Ø±</button>
        <button onclick="smartFetch('hadith.html')">ğ“ƒ— Ø¨Ø§Ø¨ Ø§Ù„Ø£Ø­Ø§Ø¯ÙŠØ«</button>
        <button onclick="smartFetch('duas.html')">ğ“€  Ø¨Ø§Ø¨ Ø§Ù„Ø£Ø¯Ø¹ÙŠØ©</button>
        <button onclick="smartFetch('werd.html')">ğ“ Ø¨Ø§Ø¨ Ø§Ù„ÙˆØ±Ø¯</button>
        <button class="btn-main" onclick="downloadImage()">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø®Ø·ÙˆØ·Ø© ÙƒØµÙˆØ±Ø© ğŸ“¥</button>
    </div>

    <script>
        async function smartFetch(url) {
            const loader = document.getElementById('loader');
            const display = document.getElementById('display-text');
            loader.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ø³ØªØ­Ø¶Ø§Ø± Ø§Ù„Ù†Øµ Ù…Ù† Ø§Ù„Ø®Ø²Ø§Ø¦Ù† Ø§Ù„Ù…Ù„ÙƒÙŠØ©...";
            display.style.opacity = "0.3";

            try {
                const response = await fetch(url);
                const html = await response.text();
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');

                const keywords = ['Ø§Ù„Ù„Ù‡', 'Ø§Ù„Ù„Ù‡Ù…', 'Ù‚Ø§Ù„', 'Ø±Ø³ÙˆÙ„', 'Ø³Ø¨Ø­Ø§Ù†', 'Ø§Ù„Ø­Ù…Ø¯', 'Ø¢Ù…Ù†ÙˆØ§', 'ÙŠØ§ Ø±Ø¨', 'ØµÙ„Ù‰'];

                let rawElements = Array.from(doc.querySelectorAll('p, li, span, h3, div'));
                let validTexts = rawElements
                    .map(el => el.innerText.trim())
                    .filter(t => {
                        const isLongEnough = t.length > 25 && t.length < 350;
                        const hasKeywords = keywords.some(k => t.includes(k));
                        return isLongEnough && hasKeywords;
                    });

                setTimeout(() => {
                    if (validTexts.length > 0) {
                        display.innerText = validTexts[Math.floor(Math.random() * validTexts.length)];
                        loader.innerText = "ØªÙ…Øª Ø§Ù„Ù…Ù‡Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­.";
                    } else {
                        display.innerText = "Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø§Ù„Ø®Ø²Ø§Ù†Ø© Ù…ØºÙ„Ù‚Ø© Ø­Ø§Ù„ÙŠØ§Ù‹.. Ø­Ø§ÙˆÙ„ Ù„Ø§Ø­Ù‚Ø§Ù‹.";
                        loader.innerText = "";
                    }
                    display.style.opacity = "1";
                }, 500);

            } catch (e) {
                loader.innerText = "Ø®Ø·Ø£: ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±.";
                display.style.opacity = "1";
            }
        }

        function downloadImage() {
            const btn = document.querySelector('.btn-main');
            btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...";
            html2canvas(document.getElementById('myCard'), { 
                scale: 3,
                backgroundColor: null
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = 'Royal_Manuscript.png';
                link.href = canvas.toDataURL();
                link.click();
                btn.innerText = "ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø®Ø·ÙˆØ·Ø© ÙƒØµÙˆØ±Ø© ğŸ“¥";
            });
        }
    </script>
</body>
</html>
