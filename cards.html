<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¯ÙŠÙˆØ§Ù† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ù„ÙƒÙŠ</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@700&family=Reem+Kufi:wght@500&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --turq: #005f73;
            --ruby: #9b2226;
            --gold: #ae934d;
            --parchment: #fdf5e6;
        }

        body {
            background-color: #121212;
            color: var(--gold);
            font-family: 'Reem Kufi', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¹Ø«Ù…Ø§Ù†ÙŠØ© */
        .card-box {
            width: 380px;
            height: 520px;
            background: var(--parchment);
            border: 12px solid var(--turq);
            border-image: url('https://www.transparenttextures.com/patterns/arabesque.png') 30 stretch;
            position: relative;
            padding: 40px 20px;
            box-sizing: border-box;
            box-shadow: 0 0 40px rgba(0,0,0,0.8);
            display: flex;
            flex-direction: column;
            justify-content: center;
            background-image: url('https://www.transparenttextures.com/patterns/shattered.png');
        }

        .card-box::before {
            content: "âšœ";
            position: absolute; top: 10px; left: 50%; transform: translateX(-50%);
            font-size: 2rem; color: var(--gold);
        }

        #display-text {
            font-family: 'Amiri', serif;
            color: #1a1a1a;
            font-size: 1.5rem;
            line-height: 1.8;
            text-align: center;
            z-index: 2;
        }

        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
        .grid-menu {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            width: 100%;
            max-width: 380px;
            margin-top: 25px;
        }

        button {
            padding: 12px;
            background: var(--turq);
            color: var(--gold);
            border: 1px solid var(--gold);
            cursor: pointer;
            font-family: 'Reem Kufi', sans-serif;
            transition: 0.3s;
        }

        button:hover { background: var(--ruby); color: white; }

        .btn-main { grid-column: span 2; background: var(--ruby); color: white; font-weight: bold; }

        #loader { font-size: 0.9rem; margin-top: 10px; color: var(--gold); height: 20px; }
    </style>
</head>
<body>

    <h1 style="font-family: 'Amiri';">Ù…ÙÙˆÙ„Ù‘Ø¯ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¯ÙŠÙˆØ§Ù†ÙŠ</h1>

    <div class="card-box" id="myCard">
        <div id="display-text">Ø§Ø®ØªØ± Ø¨Ø§Ø¨Ø§Ù‹ Ù…Ù† Ø£Ø¨ÙˆØ§Ø¨ Ø§Ù„Ø®ÙŠØ± Ø¨Ø§Ù„Ø£Ø³ÙÙ„ Ù„Ø³Ø­Ø¨ Ø§Ù„Ù†Øµ...</div>
        <div style="position:absolute; bottom:15px; width:100%; text-align:center; font-size:0.7rem; color:var(--turq);">
            Ø±ÙˆØ¶Ø© Ø§Ù„Ø°ÙƒØ± ÙˆÙ†Ø¨Ø¶ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…
        </div>
    </div>

    <div id="loader"></div>

    <div class="grid-menu">
        <button onclick="smartFetch('azkar.html')">Ø¨Ø§Ø¨ Ø§Ù„Ø£Ø°ÙƒØ§Ø±</button>
        <button onclick="smartFetch('hadith.html')">Ø¨Ø§Ø¨ Ø§Ù„Ø£Ø­Ø§Ø¯ÙŠØ«</button>
        <button onclick="smartFetch('duas.html')">Ø¨Ø§Ø¨ Ø§Ù„Ø£Ø¯Ø¹ÙŠØ©</button>
        <button onclick="smartFetch('werd.html')">Ø¨Ø§Ø¨ Ø§Ù„ÙˆØ±Ø¯</button>
        <button class="btn-main" onclick="downloadImage()">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© ÙƒØµÙˆØ±Ø© ğŸ“¥</button>
    </div>

    <script>
        async function smartFetch(url) {
            const loader = document.getElementById('loader');
            const display = document.getElementById('display-text');
            loader.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø¯ÙŠÙˆØ§Ù†...";

            try {
                const response = await fetch(url);
                const html = await response.text();
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');

                // Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ© Ù„Ø¶Ù…Ø§Ù† Ø³Ø­Ø¨ Ù†ØµÙˆØµ Ø¯ÙŠÙ†ÙŠØ© ÙˆÙ„ÙŠØ³ Ø£Ø²Ø±Ø§Ø±
                const keywords = ['Ø§Ù„Ù„Ù‡', 'Ø§Ù„Ù„Ù‡Ù…', 'Ù‚Ø§Ù„', 'Ø±Ø³ÙˆÙ„', 'Ø³Ø¨Ø­Ø§Ù†', 'Ø§Ù„Ø­Ù…Ø¯', 'Ø¢Ù…Ù†ÙˆØ§', 'ÙŠØ§ Ø±Ø¨'];

                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù†ØµÙˆØµ ÙÙŠ Ø§Ù„ÙÙ‚Ø±Ø§Øª ÙˆØµÙÙˆÙ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù…
                let rawElements = Array.from(doc.querySelectorAll('p, li, span, h3, div'));
                let validTexts = rawElements
                    .map(el => el.innerText.trim())
                    .filter(t => {
                        // Ø´Ø±ÙˆØ· ØµØ§Ø±Ù…Ø©: Ø·ÙˆÙ„ Ù…Ù†Ø§Ø³Ø¨ + ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ÙƒÙ„Ù…Ø§Øª Ø¯ÙŠÙ†ÙŠØ© + Ù„Ø§ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ÙƒÙ„Ù…Ø§Øª ØªÙ‚Ù†ÙŠØ©
                        const isLongEnough = t.length > 30 && t.length < 300;
                        const hasKeywords = keywords.some(k => t.includes(k));
                        const isNotMenu = !t.includes('Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©') && !t.includes('Ø§ØªØµÙ„');
                        return isLongEnough && hasKeywords && isNotMenu;
                    });

                if (validTexts.length > 0) {
                    // Ø§Ø®ØªÙŠØ§Ø± Ù†Øµ Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ù…Ù† Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù…ÙÙ„ØªØ±Ø©
                    display.innerText = validTexts[Math.floor(Math.random() * validTexts.length)];
                    loader.innerText = "ØªÙ… Ø§Ø³ØªØ­Ø¶Ø§Ø± Ø§Ù„Ù†Øµ Ø¨Ù†Ø¬Ø§Ø­.";
                } else {
                    display.innerText = "ØªØ¹Ø°Ø± Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù†Øµ Ù…Ù†Ø§Ø³Ø¨ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø©ØŒ ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù†ØµÙˆØµ Ù…ÙƒØªÙˆØ¨Ø©.";
                    loader.innerText = "";
                }
            } catch (e) {
                loader.innerText = "Ø®Ø·Ø£: ØªØ£ÙƒØ¯ Ù…Ù† ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¹Ø¨Ø± Ø±Ø§Ø¨Ø· GitHub.";
            }
        }

        function downloadImage() {
            html2canvas(document.getElementById('myCard'), { scale: 3 }).then(canvas => {
                const link = document.createElement('a');
                link.download = 'Islamic_Card.png';
                link.href = canvas.toDataURL();
                link.click();
            });
        }
    </script>
</body>
</html>
